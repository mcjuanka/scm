/*
 * jQuery treegrid Plugin - Juan Carlos Muñoz..! - Oct - 2017
 *
 * Copyright 2012, Grégoire Dubourg
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
!function(t){function e(){function e(a,l){var s=t("<tr>"),r=l+1;t.each(a,function(a,h){var p="p_row"+h.idp,f="p_row"+h.id;i(s=t('<tr data-level="'+l+'" class="'+p+'" data-stat="0">'),h);var u=0;for(var g in n)if(o=t("<td>"),d=n[g].width?n[g].width:d,o.width(d),"action"==n[g].type){var v=n[g].ItemAction,C=t("<div>");for(var x in v){var b=t(v[x].obj);i(b,h,v[x].onClick),b.append(v[x].icons),C.append(b)}o.append(C),s.append(o)}else if(h.children){if(0==u){var m=t('<img src="img/expand.png" class="img_exp">');m.click(function(e){"0"==t("."+f).attr("data-stat")?(t("."+f).attr("data-stat",1),m.attr("src","img/collapse.png")):(t("."+f).attr("data-stat",0),m.attr("src","img/expand.png"))}),o.append(m),u=1}else o.append("<b>"+h[n[g].field]);s.append(o)}else"id"!=n[g].field&&o.append(h[n[g].field]),s.append(o);s.click(function(){t(this).hasClass("highlight")?t(this).removeClass("highlight"):t(this).addClass("highlight").siblings().removeClass("highlight")}),s.appendTo(c),h.children&&($exp=1,e(h.children,r))})}var a=l.data,n=l.fields,d=100,r=t('<table class="table treegrid table-bordered table-fix">'),h=t("<thead>"),c=t("<tbody>");s.append(r),l.height&&(s.height(l.height),c.height(l.height));var p=t("<tr>"),o="";if(n){n.length;var f="";for(var u in n)o=t('<th text-align="center">'),d=n[u].width?n[u].width:d,o.width(d),p.append(o),f=(n[u].title,n[u].title.toUpperCase()),o.append(f);h.append(p)}return r.append(h),r.append(c),e(a,0),r}function i(t,e,i){t.click(function(t){i?i.call(this,e):l.onClickEvent.call(this,e)})}function a(e){e.hasChildren()&&(e.children("td:first").find("img").click(function(i){if(!t(i.target).is(l.ignoreClickOn))return e.toggle(),!1}),l.collapsedByDefault?e.collapse():e.expand())}function n(e){return parseInt(t(e).data(l.dataAttribute))}function d(e){return nodeLevel=n(e),childrenLevel=nodeLevel+1,t(e).nextUntil("tr[data-"+l.dataAttribute+"="+nodeLevel+"]","tr[data-"+l.dataAttribute+"="+childrenLevel+"]")}var l,s;t.fn.treegrid=function(i){i.data,t("<div>");l=t.extend({},t.fn.treegrid.defaults,i);return(s=t(this)).append(e()),this.each(function(){t(this).find("tbody tr").each(function(){a(t(this))})})},t.fn.treegrid.defaults={data:[],fields:[],width:100,height:350,dataAttribute:"level",collapsedByDefault:!0,ignoreClickOn:"input, a",onClickEvent:function(){}},t.fn.treegrid.load=function(){l.data=arguments,s.append(e())},t.fn.collapse=function(){return t(this).hasChildren()&&(t(this).removeClass("expanded").addClass("collapsed"),d(t(this)).each(function(){var e=t(this).children("td:first").find("img");"1"==t(this).attr("data-level")?e.css("padding-left","15px"):e.css("padding-left","25px"),t(this).attr("data-stat",0),e.attr("src","img/expand.png"),t(this).fadeOut("slow",function(){}).collapse()})),this},t.fn.expand=function(){return t(this).hasChildren()&&(t(this).removeClass("collapsed").addClass("expanded"),d(t(this)).each(function(){t(this).fadeIn("slow",function(){})})),this},t.fn.hasChildren=function(){return d(t(this)).length>0},t.fn.toggle=function(){return t(this).hasClass("collapsed")?t(this).expand():t(this).collapse(),this}}(jQuery);